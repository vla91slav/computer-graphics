<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лабораторная работа №2 вариант 7</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
    <script src="https://cdn.jsdelivr.net/npm/konva@8.3.1/konva.min.js"></script>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <!-- <canvas id="myCanvas" width="800" height="800"></canvas> -->
    <div id="wrapper">
        <button id="zoomin" class="nav" title="Zoom In" onclick="zoomIn()">&#43;</button>
        <button id="zoomout" class="nav" title="Zoom Out" onclick="zoomOut()">&#8722;</button>
        <button id="panup" class="nav" title="Up" onclick="panUp()">&#8679;</button>
        <button id="pandown" class="nav" title="Down" onclick="panDown()">&#8681;</button>
        <button id="panleft" class="nav" title="Left" onclick="panLeft()">&#8678;</button>
        <button id="panright" class="nav" title="Right" onclick="panRight()">&#8680;</button>
      </div>
      <div id="wrapper">
        <canvas id="canvas" width="400" height="400"></canvas>
        <canvas id="canvasX" width="400" height="400"></canvas>
      </div>
    <div><button id="window" hidden>new window</button></div>
</body>
<script>
    require('./js/renderer.js')
</script>
<script>
    var canvas = document.getElementById("canvas")
    var ctx = canvas.getContext("2d")
    var canvas1 = document.getElementById("canvasX")
    var ctxX = canvas1.getContext("2d")

    var cw = canvas.width
    var ch = canvas.height
    var mapW = 200
    var mapH = 200
    var panX = 0
    var panY = 0
    var scaleFactor = 1.00

    drawTranslated()

    function zoomIn() {
        document.getElementById("zoomin").click(); {
            scaleFactor *= 1.1
            drawTranslated()
        }
    }

    function zoomOut() {
        document.getElementById("zoomout").click(); {
            scaleFactor /= 1.1
            drawTranslated()
        }
    }

    function panUp() {
        document.getElementById("panup").click(); {
            panY -= 25
            drawTranslated()
        }
    }

    function panDown() {
        document.getElementById("pandown").click(); {
            panY += 25
            drawTranslated()
        }
    }

    function panLeft() {
        document.getElementById("panleft").click(); {
            panX -= 25
            drawTranslated()
        }
    }

    function panRight() {
        document.getElementById("panright").click(); {
            panX += 25
            drawTranslated()
        }
    }

    function drawTranslated() {
        // canvas
        ctx.clearRect(0, 0, cw, ch)
        ctx.save()
        ctx.translate(cw / 2, ch / 2)
        ctx.scale(scaleFactor, scaleFactor)
        ctx.translate(panX, panY)
        ctx.fillStyle = "Green"
        // ctx.fillRect(mapW / -2, mapH / -2, mapW, mapH)

        // фигура
        ctx.beginPath();
        let x = 0
        let y = 0
        const pi = Math.PI
        ctx.arc(x, y, 40, pi/4, pi-pi/4, true) // внутренняя окружность
        ctx.moveTo(x + 50, y)
        ctx.arc(x, y, 50, 0, pi, true) // внешняя окружность
        ctx.moveTo(x - 50, y)
        ctx.lineTo(x - 50, y + 60)
        ctx.lineTo(x + 50, y + 60)
        ctx.lineTo(x + 50, y)

        // хорда
        ctx.moveTo(40 * Math.cos(pi/4), 40 * Math.sin(pi-pi/4))
        ctx.lineTo(x - 40 * Math.cos(pi/4), 40 * Math.sin(pi-pi/4))

        // треугольник
        ctx.moveTo(x + 45, y + 55)
        ctx.lineTo(x + 25, y + 55)
        ctx.lineTo(x + 45, y + 35)
        ctx.lineTo(x + 45, y + 55)

        // кнопка сверху
        ctx.moveTo(50 * Math.cos(pi/2 - pi/10), 50 * Math.sin(pi + (pi/2 - pi/10)))
        ctx.lineTo(50 * Math.cos(pi/2 - pi/10), 50 * Math.sin(pi + (pi/2 - pi/10)) - 8)
        ctx.lineTo(50 * Math.cos(-pi/2 - pi/10), 50 * Math.sin(pi + (pi/2 - pi/10)) - 8)
        ctx.lineTo(50 * Math.cos(-pi/2 - pi/10), 50 * Math.sin(pi + (pi/2 - pi/10)))

        // подставка
        ctx.moveTo(x - 50, y + 70)
        ctx.lineTo(x + 50, y + 70)
        ctx.lineTo(x + 50, y + 110)
        ctx.lineTo(x - 50, y + 110)
        ctx.lineTo(x - 50, y + 70)

        // текстура подставки
        for (let i = 0; i < 100; i += 4) {
            ctx.moveTo((x - 50) + i, y + 70)
            ctx.lineTo((x - 50) + i, y + 110)
        }
        for (let i = 0.8; i < 16; i *= 2) {
            ctx.moveTo((x - 50) + i, y + 70)
            ctx.lineTo((x - 50) + i, y + 110)
        }
        for (let i = 0.8; i < 16; i *= 2) {
            ctx.moveTo((x + 50) - i, y + 70)
            ctx.lineTo((x + 50) - i, y + 110)
        }

        ctx.moveTo(x - 15, y + 70)
        ctx.lineTo(x - 15, y + 85)
        ctx.lineTo(x + 15, y + 85)
        ctx.lineTo(x + 15, y + 70)
        for (let i = 0; i < 30; i += 3) {
            ctx.moveTo((x - 15) + i, y + 70)
            ctx.lineTo((x - 15) + i, y + 85)
        }

        ctx.moveTo(x - 35, y + 110)
        ctx.lineTo(x - 35, y + 105)
        ctx.lineTo(x + 35, y + 105)
        ctx.lineTo(x + 35, y + 110)

        ctx.stroke()

        ctx.restore()

        // // canvasX
        // ctxX.clearRect(0, 0, cw, ch)
        // ctxX.save()
        // ctxX.translate(cw / 2, ch / 2)
        // ctxX.beginPath()

        // ctxX.moveTo(0, 25)
        // ctxX.lineTo(0, -25)
        // ctxX.moveTo(-25, 0)
        // ctxX.lineTo(25, 0)

        // ctxX.closePath()
        // ctxX.lineWidth = 1
        // ctxX.strokeStyle = 'Black'
        // ctxX.stroke()
        // ctxX.restore()
    }
</script>
<!-- <script>
    // let canvas = document.getElementById('canvas');
    // let ctx = canvas.getContext('2d');
    // let scale = 1

    // function draw() {
    //     if (canvas.getContext) {
    //         ctx.beginPath();
    //         let x = 75
    //         let y = 75
    //         const pi = Math.PI
    //         ctx.arc(x, y, 40, pi/4, pi-pi/4, true) // внутренняя окружность
    //         ctx.moveTo(x + 50, y)
    //         ctx.arc(x, y, 50, 0, pi, true) // внешняя окружность
    //         ctx.moveTo(x - 50, y)
    //         ctx.lineTo(x - 50, y + 50)
    //         ctx.lineTo(x + 50, y + 50)
    //         ctx.lineTo(x + 50, y)
    //         ctx.moveTo(x + 40, y)
    //         ctx.stroke();
    //     }
    // }

    // function zoom(event) {
    //     event.preventDefault()
    //     const delta = event.wheelDelta ? event.wheelDelta / 40 : event.deltaY ? -event.deltaY : 0
    //     if (delta) {
    //         const x = event.offsetX
    //         const y = event.offsetY
    //         const pointBefore = { x: (x - canvas.width / 2) / scale, y: (y - canvas.height / 2) / scale }
    //         scale += delta > 0 ? 0.1 : -0.1
    //         const pointAfter = { x: (x - canvas.width / 2) / scale, y: (y - canvas.height / 2) / scale }
    //         const dx = pointAfter.x - pointBefore.x
    //         const dy = pointAfter.y - pointBefore.y
    //         ctx.translate(dx * scale, dy * scale)
    //         ctx.scale(scale, scale)
    //         ctx.clearRect(0, 0, canvas.width, canvas.height)
    //         draw()
    //     }
    // }


    // draw()
    // // canvas.addEventListener("wheel", zoom)
    // canvas.addEventListener("wheel", (event) => {
    //     event.preventDefault()
    //     if (event.deltaY < 0) {
    //         ctx.scale(1.05,1.05, canvas.width/2, canvas.height/2)
    //     } else {
    //         ctx.scale(-0.95,-0.95, canvas.width/2, canvas.height/2)
    //     }
    //     ctx.clearRect(0, 0, canvas.width, canvas.height)
    //     draw()
    // })
</script> -->
</html>